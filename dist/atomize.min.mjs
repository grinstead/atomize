var g={},l={},m={},p={},t={};
function u(a){return function(b){function c(e){var h=void 0===e?a.o:null===e?a.i:"boolean"===typeof e?a.g:"number"===typeof e?a.j:"string"===typeof e?a.l:"function"===typeof e?a.h:"symbol"===typeof e?a.m:e instanceof Map?a.Map:e instanceof Set?a.Set:Array.isArray(e)?a.Array:(h=Object.getPrototypeOf(e))&&h!==Object.prototype?a.instance:a.object;var I=q,J=k,v=f.length;q=e;k=v;h(e,d)?n.set(e,0<=k?k<<1|1:-k):0>k&&n.delete(e);if(v===f.length)throw Error("Value encoded into nothing "+String(e));q=I;k=J}
function d(e,h){if(h===g)f.push(e);else if(h===l)f.push(28,e);else if(e===m)q!==g&&(0<=k&&(k=~(k<<1)),n.set(q,-k),q=g);else if(e===p)r.push(f.push(-1)-1);else if(e===t)f[r.pop()]=f.length;else if(0<=k&&(k=~(k<<1),n.set(e,-1)),h=n.get(e),null!=h){if(-1===h)throw Error("Infinite loop when encoding "+e);f.push(0<=h?h:-h)}else c(e)}var f=[],n=new Map,r=[],k=0,q=g;c(b);return f}}function w(a){a(2,g)}function x(a){a(4,g)}function y(a,b){b(a?6:8,g)}
function z(a,b){if(a!==a)return b(10,g),!1;a===(a|0)?(b(12,g),b(a,g)):(b(14,g),b(a,g));return!0}function A(a,b){b(m);b(16,g);b(p);for(var c=a.length,d=0;d<c;d++)b(a[d]);b(t);return!0}function B(a,b){b(18,g);b(a,g);return!0}function C(a,b){b(m);b(20,g);b(p);a.forEach(function(c,d){b(d)});b(t);a.forEach(function(c){b(c)});return!0}function D(a,b){b(m);b(22,g);b(p);a.forEach(function(c){b(c)});b(t);return!0}
function E(a,b){b(m);b(24,g);var c=Object.keys(a),d=c.length;b(p);for(var f=0;f<d;f++)b(c[f]);b(t);for(f=0;f<d;f++)b(a[c[f]]);return!0}function F(a,b){return a?function(c,d){d(26,g);return a(c,d)}:b}
function G(a,b,c,d){d=c(d);if(d===t)return t;if(d&1)return a[d>>1];switch(d){case 4:return null;case 6:return!0;case 8:return!1;case 10:return NaN;case 12:return c();case 14:return c();case 16:return[];case 18:return c();case 20:return new Map;case 22:return new Set;case 24:d={};a.push(d);for(var f=c(),n=a.length,r;(r=G(a,b,c,f))!==t;)r!==g&&a.push(r);for(f=a.length;n<f;n++)d[a[n]]=H(a,b,c);return g;case 26:return null}}
function H(a,b,c){var d=a.length;b=G(a,b,c,-1);if(b===g)return a[d];a.push(b);return b};function K(a){throw Error("No way to atomize "+String(a));}function L(a,b){b(a,l);return!0}export const ALLOW_SELF_REFERENCE=m;export const encodeVoid=w;export const encodeNull=x;export const encodeBoolean=y;export const encodeNumber=z;export const encodeArray=A;export const encodeString=B;export const encodeMap=C;export const encodeSet=D;export const encodeObject=E;export const AS_IS=l;
export const atomizer=function(a){a=void 0===a?{}:a;var b=a.keepUnknownsAsIs?L:K;return u({o:F(a["void"],w),i:F(a["null"],x),g:F(a["boolean"],y),j:F(a.number,z),Array:F(a.Array,A),l:F(a.string,B),Map:F(a.Map,C),Set:F(a.Set,D),object:F(a.object,E),h:F(a["function"],b),m:F(a.symbol,b),instance:F(a.instance,b)})};export const rebuilder=function(a){return function(b){var c=0,d=b.length;return H([],a,function(f){if(c===f)return t;if(c===d)throw Error("Incomplete data");return b[c++]})}};
